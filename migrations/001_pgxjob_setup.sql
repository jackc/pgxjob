create table pgxjob_queues (
	id int primary key generated by default as identity,
	name text not null unique
);

create table pgxjob_types (
	id int primary key generated by default as identity,
	name text not null unique
);

create table pgxjob_jobs (
	id bigint primary key generated by default as identity,
	queue_id int not null, -- purposely not a foreign key for best insert performance. pgxjob_queues rows are never deleted.
	priority integer not null,
	type_id int not null, -- purposely not a foreign key for best insert performance. pgxjob_types rows are never deleted.
	params json, -- use json instead of jsonb as it is faster for insert.
	queued_at timestamptz not null,
	run_at timestamptz not null,
	next_run_at timestamptz not null,
	error_count integer not null default 0,
	last_error text
);
